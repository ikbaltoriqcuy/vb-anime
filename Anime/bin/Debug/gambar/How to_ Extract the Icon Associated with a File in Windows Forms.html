<!DOCTYPE html>
<!-- saved from url=(0064)https://msdn.microsoft.com/en-us/library/ms404308(v=vs.110).aspx -->
<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="WT.seg_1" content="en-us"><link rel="canonical" href="./How to_ Extract the Icon Associated with a File in Windows Forms_files/How to_ Extract the Icon Associated with a File in Windows Forms.html">
    <title>How to: Extract the Icon Associated with a File in Windows Forms</title>






<meta name="DCS.dcsuri" content="/en-us/library/ms404308(d=default,l=en-us,v=vs.110).aspx">

<meta name="NormalizedUrl" content="https://msdn.microsoft.com/en-us/library/ms404308(d=default,l=en-us,v=vs.110).aspx">

<meta name="ms.normalizedurl" content="https://msdn.microsoft.com/en-us/library/ms404308(d=default,l=en-us,v=vs.110).aspx">

<meta name="DCS.appliesToProduct" content="">

<meta name="DCS.appliesToTechnology" content="">

<meta name="DCS.appliesToVersion" content="">

<meta name="ms.prod" content=".net-framework-4.6">

<meta name="ms.service" content="">

<meta name="ms.devlang" content="dotnet">

<meta name="ms.topic" content="article">

<meta name="AmbientContext" content="{&quot;layout.limit_max_width&quot;:false,&quot;AmbientContextId&quot;:&quot;39766A11-ED2A-4CE7-9FD4-36049BA22E8C&quot;,&quot;display.use_large_font&quot;:true,&quot;AmbientContextDownstream&quot;:{},&quot;display.high_contrast&quot;:false}">

<meta name="VotingContextUrl" content="https://msdn.microsoft.com/en-us/library/ms404308(d=default,l=en-us,v=vs.110).aspx">

<meta name="MN" content="EE4293C3-7:35:34 PM">

<meta name="Search.ShortId" content="ms404308">

<meta name="ms.shortidmsdn" content="ms404308">

<meta name="Ms.Locale" content="en-us">

<meta name="ms.prodver" content="VS.110">

<meta name="ms.contentlang" content="EN">

<meta name="ms.lang" content="EN">

<meta name="ms.loc" content="US">

<meta name="ms.sitever" content="2015.10.22.2">

<meta name="ms.assetid" content="88e2ad8b-c34f-415a-84f2-dad756b5c928">

<meta name="ms.auth" content="0">

<meta name="ms.custom" content="">

<meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    









    <script type="text/javascript" src="./How to_ Extract the Icon Associated with a File in Windows Forms_files/ai.0.js" async=""></script><script type="text/javascript" data-do-not-move="true">
        //<![CDATA[
        var AmbientContext = null;

        (function(){
            var root = (function(){return this;}).call(null);

            var GetCookie = function(name){
                var cookies = root.document.cookie ? root.document.cookie.split('; ') : [];
                for (var i = 0; i < cookies.length; i++) {
                    var pos = cookies[i].indexOf('=');
                    if (name === root.decodeURIComponent(cookies[i].slice(0, pos)))
                    {
                        var cookie = cookies[i].slice(pos + 1).replace(/\+/g, ' ');
                        cookie = root.decodeURIComponent(cookie);
                        return cookie;
                    }
                }
            };

            var JsonDeserialize = function(content) {
                return root.JSON && root.JSON.parse ? root.JSON.parse(content) : (new Function('return (' + content + ')'))();
            };

            try {
                AmbientContext = GetCookie('AmbientContext');
                AmbientContext = AmbientContext && JsonDeserialize(AmbientContext);
            } catch(ex) {
            } finally {
                AmbientContext = AmbientContext || null;
            }
        })();
        //]]>
    </script>

    <script type="text/javascript" src="./How to_ Extract the Icon Associated with a File in Windows Forms_files/jquery-1.8.2.min.js" data-do-not-move="true" data-provides="jQuery"></script>
    
<link rel="stylesheet" type="text/css" href="./How to_ Extract the Icon Associated with a File in Windows Forms_files/Combined.css"><script class="mtps-injected">try {
/**/
(window.MTPS || (window.MTPS = {})).cdnDomains || (window.MTPS.cdnDomains = { 
	"image": "https://i-msdn.sec.s-msft.com", 
	"js": "https://i2-msdn.sec.s-msft.com", 
	"css": "https://i-msdn.sec.s-msft.com", 
	"xap": "https://msdn.microsoft.com"
});
/**/
} finally { MTPS._injectNextScript_0 && MTPS._injectNextScript_0(); }</script><script class="mtps-injected">try {
//
  var literalNormalizedUrl = '/en-us/library/ms404308(l=en-us,v=vs.110).aspx';
  var wt_nvr_ru = 'WT_NVR_RU';
  var wt_fpcdom = '.microsoft.com';
  var wt_domlist = 'msdn.microsoft.com';
  var wt_pathlist = '';
  var wt_paramlist = 'DCSext.mtps_devcenter';
  var wt_siteid = 'MSDN';
  var gDomain = 'm.webtrends.com';
  var gDcsId = 'dcsmgru7m99k7mqmgrhudo0k8_8c6m';
  var gFpc = 'WT_FPC';



  if (document.cookie.indexOf(gFpc + "=") == -1) {
    var wtidJs = document.createElement("script");
    wtidJs.src = "//" + gDomain + "/" + gDcsId + "/wtid.js";
    document.getElementsByTagName("head")[0].appendChild(wtidJs);
  }



  var detectedLocale = 'en-us';
  var wtsp = 'msdnlib_dotnet';
  var gTrackEvents = '0';
/**/
} finally { MTPS._injectNextScript_1 && MTPS._injectNextScript_1(); }</script><script class="mtps-injected">try {
//

        window.appInsightsId = '60854590-027a-4ae4-98be-2741a40f355f';
        //
} finally { MTPS._injectNextScript_2 && MTPS._injectNextScript_2(); }</script><script class="mtps-injected" src="./How to_ Extract the Icon Associated with a File in Windows Forms_files/Combined.js"></script><link href="./How to_ Extract the Icon Associated with a File in Windows Forms_files/PrintView.css" rel="stylesheet" type="text/css" media="print"><script type="text/javascript" src="./How to_ Extract the Icon Associated with a File in Windows Forms_files/ms.js"></script><script class="mtps-injected" src="./How to_ Extract the Icon Associated with a File in Windows Forms_files/SearchBox.jss"></script><script class="mtps-injected">try {
MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = 'Expand'; MTPS.LocalizedStrings.CollapseButtonTooltip = 'Collapse'; MTPS.LocalizedStrings.EnhancedExpandTooltip = 'Click to expand. Double-click to expand all.'; MTPS.LocalizedStrings.EnhancedCollapseTooltip = 'Click to collapse. Double-click to collapse all.'; MTPS.LocalizedStrings.ExpandAllButtonTooltip = 'Expand All'; MTPS.LocalizedStrings.CollapseAllButtonTooltip = 'Collapse All';
} finally { MTPS._injectNextScript_5 && MTPS._injectNextScript_5(); }</script><script class="mtps-injected" src="./How to_ Extract the Icon Associated with a File in Windows Forms_files/Combined(1).js"></script><script src="./How to_ Extract the Icon Associated with a File in Windows Forms_files/broker.js"></script><script class="mtps-injected">try {
$(document).ready(function() {
        try {
            var token = $("#globalRequestVerification input[name='__RequestVerificationToken']").clone();
            $("#siteFeedbackForm").append(token);
        } catch(err) {
            
        }
    });
} finally { MTPS._injectNextScript_7 && MTPS._injectNextScript_7(); }</script></head>
<body class="library Chrome">
    <div id="page">

        

        

        
    

    
    <link type="text/css" rel="stylesheet">
    
        
        
    <input type="hidden" id="isHeaderBleeding" value="true">
    <div id="ux-header" dir="ltr" class="ltr msdn" data-device-type="desktop">
        

      <header ms.pgarea="header">
        <span id="singleCol"></span>
        <span id="doubleCol"></span>
        <span id="isMobile"></span>
        <div>
          <div class="row topRow">
            <div class="top">
              <div class="left">
                  <a class="msdnLogoImg" href="https://msdn.microsoft.com/en-us" title="MSDN home">
                      <div id="msft-logo" class="msft-logo"></div>
                  </a>
                <div class="GrayPipe"></div>
                  <a class="DevCenterFullNameNonMegaBlade" href="https://msdn.microsoft.com/en-us">Developer Network</a>
                <a class="DevCenterFullName" href="https://msdn.microsoft.com/en-us">Developer Network</a>
                <a class="DevCenterShortName" href="https://msdn.microsoft.com/en-us">Developer</a>
              </div>
              <div class="right">
                <div id="signIn">

  <img class="profileImage" src="./How to_ Extract the Icon Associated with a File in Windows Forms_files/profile.jpg">



<a class="scarabLink" href="https://login.live.com/login.srf?wa=wsignin1.0&rpsnv=12&ct=1447040134&rver=6.0.5276.0&wp=MCMBI&wlcxt=MSDN%24MSDN%24MSDN&wreply=https%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fms404308%2528v%3dvs.110%2529.aspx&lc=1033&id=254354&mkt=en-US" title="Sign in">Sign in</a></div>




                <div class="auxNav">
                  <div>
                    <div data-fragmentname="Subscriptions" id="Fragment_Subscriptions" xmlns="http://www.w3.org/1999/xhtml">
  <a href="https://msdn.microsoft.com/subscriptions/manage/hh442900" id="Subscriptions_2153_1" xmlns="http://www.w3.org/1999/xhtml">MSDN subscriptions</a>
</div>
                    <div data-fragmentname="GetTools" id="Fragment_GetTools" xmlns="http://www.w3.org/1999/xhtml">
  <a href="http://go.microsoft.com/fwlink/?LinkId=309297&clcid=0x409&slcid=0x409&campaign=o~msft~msdn~gettools-header~dn308572" id="GetTools_2153_3" xmlns="http://www.w3.org/1999/xhtml">Get tools</a>
</div>
                  </div>                    
                </div>
              </div>
            </div>

          </div>
          <div class="row middleRow">
            <div class="expandTop" style="display: none;">
              <div class="left"></div>
              <div class="right"></div>
            </div>
          </div>
        </div>
        <div id="buttomRowWrapper" class="bg_default">
          <div class="row buttomRow bg_default">
            <div class="bottom">
              <div class="left">
                <a id="grip" class="menu-icon" href="javascript:void(0)"></a>
                
                <div id="drawer">
                  <div class="toc">
                    
        <nav>
            <ul class="navL1" ms.cmpgrp="main nav">
                        <li class="inactive toggle">
                            <a href="javascript:void(0)" title="Technologies">Technologies</a>
                                <ul class="navL2" style="display: none;">
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/cloud-app-development-msdn" title="Cloud">Cloud</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/app-development-msdn" title="App Development">App Development</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/web-app-development-msdn" title="Web">Web</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/big-data-development-msdn" title="Data">Data</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/games-development-msdn" title="Gaming">Gaming</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)" title="Downloads">Downloads</a>
                                <ul class="navL2" style="display: none;">
                                        <li class="inactive">
                                            <a href="https://www.visualstudio.com/downloads/download-visual-studio-vs" title="Visual Studio">Visual Studio</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/subscriptions" title="MSDN subscription access">MSDN subscription access</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/microsoft-sdks-msdn" title="SDKs">SDKs</a>

                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="Trial software">Trial software</a>

                                                <ul class="navL3" style="display: none;">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/evalcenter" title="Free downloads">Free downloads</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/officeevaluationresources" title="Office resources">Office resources</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/sharepoint2013resources" title="SharePoint Server 2013 resources">SharePoint Server 2013 resources</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/sqlserver2014expressresources" title="SQL Server 2014 Express resources">SQL Server 2014 Express resources</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/windowsserver2012r2resources" title="Windows Server 2012 resources">Windows Server 2012 resources</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)" title="Programs">Programs</a>
                                <ul class="navL2" style="display: none;">
                                        <li class="inactive">
                                            <a href="https://rewards.msdn.microsoft.com/" title="TechRewards">TechRewards</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://www.microsoft.com/bizspark" title="Startups">Startups</a>

                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="Students">Students</a>

                                                <ul class="navL3" style="display: none;">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/imagine/imagine-home" title="Microsoft Imagine">Microsoft Imagine</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/microsoftstudentpartners" title="Microsoft Student Partners">Microsoft Student Partners</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="Architects">Architects</a>

                                                <ul class="navL3" style="display: none;">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-overview-msdn" title="Overview">Overview</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-case-studies-msdn" title="Case studies">Case studies</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/architects-blueprints-msdn" title="Blueprints">Blueprints</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="http://blogs.msdn.com/b/msarchitecture/" title="Blog">Blog</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="http://social.msdn.microsoft.com/forums/en-us/home?brandignore=true&sort=relevancedesc&searchterm=architecture+or+architect" title="Forums">Forums</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://events.msdn.microsoft.com/" title="Events">Events</a>

                                                   
                                        </li>
                                        <li class="inactive toggle">
                                            <a href="javascript:void(0)" title="MSDN Subscriptions">MSDN Subscriptions</a>

                                                <ul class="navL3" style="display: none;">
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/msdn-subscriptions-overview" title="Overview">Overview</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/benefits-overview" title="Benefits">Benefits</a>
                                                        </li>
                                                        <li class="inactive">
                                                            <a href="https://msdn.microsoft.com/msdn-subscriptions-administration" title="Administrators">Administrators</a>
                                                        </li>
                                                </ul>
                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive toggle">
                            <a href="javascript:void(0)" title="Community">Community</a>
                                <ul class="navL2" style="display: none;">
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/magazine/dd767791" title="Magazine">Magazine</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://social.msdn.microsoft.com/forums/" title="Forums">Forums</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://blogs.msdn.com/b/developer-tools/" title="Blogs">Blogs</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://tech-advisors.msdn.microsoft.com/en-us" title="Tech Advisors">Tech Advisors</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="http://channel9.msdn.com/" title="Channel 9">Channel 9</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive current toggle">
                            <a href="javascript:void(0)" title="Documentation">Documentation</a>
                                <ul class="navL2" style="display: none;">
                                        <li class="inactive current">
                                            <a href="https://msdn.microsoft.com/library" title="APIs and reference">APIs and reference</a>

                                                   
                                        </li>
                                        <li class="inactive">
                                            <a href="https://msdn.microsoft.com/developer-centers-msdn" title="Dev centers">Dev centers</a>

                                                   
                                        </li>
                                </ul>
                        </li>
                        <li class="inactive">
                            <a href="https://code.msdn.microsoft.com/" title="Samples">Samples</a>
                        </li>
            </ul>
        </nav>

                  </div>
                </div>
              </div>
              <div class="right">
                <div data-fragmentname="SearchBox" id="Fragment_SearchBox" xmlns="http://www.w3.org/1999/xhtml">
  <div class="SearchBox">
    <form id="HeaderSearchForm" name="HeaderSearchForm" method="get">
      <button id="FakeHeaderSearchButton" value="Search" type="submit" class="header-search-button">
        <div id="search-finder" class="search-finder"></div>
      </button>
      <button id="HeaderSearchButton" style="display:none" data-searchtype="icon" data-pgarea="header" title="Search MSDN"></button>
      <div id="searchSplitter"></div>
      <div id="searchCloseIcon" class="search-clear-x"></div>
      <div id="searchTextContainer" style="width: 0px; display: none;">
        <input id="HeaderSearchTextBox" name="query" type="text" maxlength="200" onfocus="Epx.Controls.SearchBox.watermarkFocus(event, this.title)" onblur="Epx.Controls.SearchBox.watermarkBlur(event, this.title)" autocomplete="off" data-searchtype="searchbox" data-pgarea="header">
      <div id="SearchFlyoutContainer" style="display: none; text-align: left; border: 1px solid buttonshadow; position: absolute; z-index: 1000; padding: 2px; color: rgb(255, 255, 255); font-family: Arial; font-size: 16px; background-color: rgb(255, 255, 255);"><div id="SuggestionContainer"><ul data-pgarea="header" data-searchtype="search dropdown" style="list-style: none; padding: 4px 2px 0px 1px; cursor: pointer; margin: 1px; white-space: nowrap;"></ul></div></div></div>
    </form>
    
    
  </div>
</div>
              </div>
            </div>
          </div>
        </div>

      </header>

    <div id="overlayMaskHeader"></div></div>

    
    





<link type="text/css" rel="stylesheet">
<link type="text/css" rel="stylesheet">


    <div id="breadcrumbs">
        <div id="breadcrumbDesktop" class="breadCrumb">
                        <span class="breadcrumbEllipsis"><a href="https://msdn.microsoft.com/en-us/library/ms229592(v=vs.110).aspx" title="Enhancing Windows Forms Applications"></a></span>
                        <span><a href="https://msdn.microsoft.com/en-us/library/a36fascx(v=vs.110).aspx" title="Graphics and Drawing in Windows Forms"><span>Graphics and Drawing in Windows Forms</span></a></span>
                        <span><a href="https://msdn.microsoft.com/en-us/library/yhez825d(v=vs.110).aspx" title="Using Managed Graphics Classes"><span>Using Managed Graphics Classes</span></a></span>
                        <span class="breadcrumbDropSmall">
                            <a id="breadcrumbDropDownButton" href="https://msdn.microsoft.com/en-us/library/ms404308(v=vs.110).aspx#" targethref="https://msdn.microsoft.com/en-us/library/yhez825d(v=vs.110).aspx" title="Working with Images, Bitmaps, Icons, and Metafiles"><span>Working with Images, Bitmaps, Icons, and Metafiles</span></a>
                        </span>
        </div>
        <div id="breadcrumbDropDownMenu" style="display: none;"></div>
        <div id="tocDropDownMenu" style="display: none;"></div>

        <div id="breadcrumbTablet" class="breadCrumb">
                        <span class="breadcrumbEllipsis"><a href="https://msdn.microsoft.com/en-us/library/yhez825d(v=vs.110).aspx" title="Using Managed Graphics Classes"></a></span>
                    <span><a href="https://msdn.microsoft.com/en-us/library/a343dky2(v=vs.110).aspx" title="Working with Images, Bitmaps, Icons, and Metafiles"><span>Working with Images, Bitmaps, Icons, and Metafiles</span></a></span>
                <span class="breadcrumbDropSmall"><a id="tocDropDownButton" href="https://msdn.microsoft.com/en-us/library/ms404308(v=vs.110).aspx#" title="How to: Extract the Icon Associated with a File in Windows Forms"><span>How to: Extract the Icon Associated with a File in Windows Forms</span></a></span>
        <div id="navigationButtons">
            <a id="provideFeedback1" href="javascript:void(0)"><ins class="suggestion"></ins>Any suggestions?</a>
            <a id="isd_print" href="https://msdn.microsoft.com/en-us/library/ms404308(d=printer,v=vs.110).aspx" rel="nofollow"><ins class="print"></ins>Print </a>
            <a id="isd_printABook" href="https://msdn.microsoft.com/en-us/library/export/help/?returnUrl=%2fen-us%2flibrary%2fms404308(v%3dvs.110).aspx">
                <ins class="export"></ins>Export (<span class="count">0</span>)
            </a>
        </div></div>
        <div id="breadcrumbMobile" class="breadCrumb">
                <span class="breadcrumbEllipsis"><a href="https://msdn.microsoft.com/en-us/library/a343dky2(v=vs.110).aspx" title="Working with Images, Bitmaps, Icons, and Metafiles"></a></span>
            <span class="breadcrumbDropSmall"><a id="tocPopupButton" href="https://msdn.microsoft.com/en-us/library/ms404308(v=vs.110).aspx#" title="How to: Extract the Icon Associated with a File in Windows Forms"><span>How to: Extract the Icon Associated with a File in Windows Forms</span></a></span>
        </div>
    </div>
    <div id="tocPopupMenu" style="display: none;">
        <div id="tocPopMenuClose" class="tocCloseLarge"></div>
        <div id="tocTitle">How to: Extract the Icon Associated with a File in Windows Forms</div>        
    </div>

    


        <div id="body">
            <span id="tabletView_large"></span>
            <span id="tabletView_small"></span>
            <span id="mobileView"></span>
            









    <div id="leftNav" style="height: 245px;">





<div id="tocnav" class="hide-archive" ms.pgarea="left toc" style="width: 255px; position: fixed; top: 60px;">


    <div class="tocunselected">
        <div id="tocExpandArea" style="display: block;">
            <span class="toc_empty"></span>
            <span id="tocExpandButton"><a href="https://msdn.microsoft.com/en-us/library/ms404308(v=vs.110).aspx#"></a></span>
        </div>
        <div id="tocExpand"><div class="toclevel " data-toclevel="1">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/8tda2c3c(v=vs.110).aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="How to: Draw an Existing Bitmap to the Screen">How to: Draw an Existing Bitmap to the Screen</a>                </div><div class="toclevel " data-toclevel="1">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/wb42xhfh(v=vs.110).aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="How to: Load and Display Metafiles">How to: Load and Display Metafiles</a>                </div><div class="toclevel " data-toclevel="1">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/7wt4bf7h(v=vs.110).aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="How to: Crop and Scale Images">How to: Crop and Scale Images</a>                </div><div class="toclevel " data-toclevel="1">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/3b575a03(v=vs.110).aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="How to: Rotate, Reflect, and Skew Images">How to: Rotate, Reflect, and Skew Images</a>                </div><div class="toclevel " data-toclevel="1">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/k0fsyd4e(v=vs.110).aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="How to: Use Interpolation Mode to Control Image Quality During Scaling">How to: Use Interpolation Mode to Control Image Quality During Scaling</a>                </div><div class="toclevel " data-toclevel="1">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/ets0sayh(v=vs.110).aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="How to: Create Thumbnail Images">How to: Create Thumbnail Images</a>                </div></div>
    <div class="toclevel " data-toclevel="1">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/1bttkazd(v=vs.110).aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="How to: Improve Performance by Avoiding Automatic Scaling">How to: Improve Performance by Avoiding Automatic Scaling</a>                </div><div class="toclevel " data-toclevel="1">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/xddt0dz7(v=vs.110).aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="How to: Read Image Metadata">How to: Read Image Metadata</a>                </div><div class="toclevel " data-toclevel="1">
<span class="toc_empty"></span><a href="https://msdn.microsoft.com/en-us/library/ms404307(v=vs.110).aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="How to: Create a Bitmap at Run Time">How to: Create a Bitmap at Run Time</a>                </div></div>
    <div class="tocselected"><div class="toclevel current" data-toclevel="1">
<span class="toc_empty"></span><a href="./How to_ Extract the Icon Associated with a File in Windows Forms_files/How to_ Extract the Icon Associated with a File in Windows Forms.html" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="How to: Extract the Icon Associated with a File in Windows Forms">How to: Extract the Icon Associated with a File in Windows Forms</a>                </div><div class="tocPadding"></div></div>
    <div class="tocunselected">
                
                
                
                
                
                
                
                
                
                
    </div>
    <a id="tocMenuToggler" href="https://msdn.microsoft.com/en-us/library/ms404308(v=vs.110).aspx#">
        <span id="tocMenuTogglerIcon" class="tocMenuCollapse"></span>
        <div id="tocMenuTogglerLabel">TOC</div>
    </a>
</div>            <div style="display:none">
                <div id="CollapseLocalizeString">Collapse the table of content</div>
                <div id="ExpandLocalizeString">Expand the table of content</div>
            </div>
        <div>
            <a id="isd_archiveControlResponsive" style="display:none;" data-include-archive="Include Previous Version" data-exclude-archive="Exclude Previous Version">
            </a>
        </div>
    </div>
    <div id="content" class="content">







<div xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="topic">
    <h1 class="title">How to: Extract the Icon Associated with a File in Windows Forms</h1>
    
    <div class="lw_vs">
      <div id="curversion">
        <strong>
            .NET Framework 4.6 and 4.5
        </strong>
      </div>
      <div id="versionclick">
        <div id="vsseperator" class="cl_lw_vs_seperator"></div>
        <div>
          <div>
            <a id="vsLink" href="javascript:;">
                        Other Versions
                    </a>
          </div>
          <div class="cl_vs_arrow clip10x10">
            <img class="cl_lw_vs_arrow" id="vsArrow" alt="" src="./How to_ Extract the Icon Associated with a File in Windows Forms_files/ImageSprite.png">
          </div>
        </div>
        <ul id="vsPanel" style="display: none;">
          <li class="">
            <a href="https://msdn.microsoft.com/en-us/library/ms404308(v=vs.100).aspx">Visual Studio 2010</a>
          </li>
          <li class="archived">
            <a href="https://msdn.microsoft.com/en-us/library/ms404308(v=vs.90).aspx">.NET Framework 3.5</a>
          </li>
          <li class="">
            <a href="https://msdn.microsoft.com/en-us/library/ms404308(v=vs.85).aspx">.NET Framework 3.0</a>
          </li>
          <li class="archived">
            <a href="https://msdn.microsoft.com/en-us/library/ms404308(v=vs.80).aspx">.NET Framework 2.0</a>
          </li>
          <li id="vsExpand" style="display: list-item;">
            <span class="breadcrumbEllipsis">
              <a href="https://msdn.microsoft.com/en-us/library/ms404308(v=vs.110).aspx#"></a>
            </span>
          </li>
        </ul>
      </div>
    </div>
    <div style="clear:both;"></div>
    <div id="mainSection">
      <div id="mainBody">&nbsp;<div class="introduction"><p>Many files have embedded icons that provide a visual representation of the associated file type. For example, Microsoft Word documents contain an icon that identifies them as Word documents. When displaying files in a list control or table control, you may want to display the icon representing the file type next to each file name. You can do this easily by using the <a href="https://msdn.microsoft.com/en-us/library/system.drawing.icon.extractassociatedicon(v=vs.110).aspx">ExtractAssociatedIcon</a> method. </p></div><div class="section"><div class="description"><div class="section"><p>The following code example demonstrates how to extract the icon associated with a file and display the file name and its associated icon in a <a href="https://msdn.microsoft.com/en-us/library/system.windows.forms.listview(v=vs.110).aspx">ListView</a> control.</p></div></div>
<div id="code-snippet-1" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        <div class="codeSnippetContainerTab" dir="ltr"><a href="https://msdn.microsoft.com/en-us/library/ms404308(v=vs.110).aspx?cs-save-lang=1&cs-lang=csharp#code-snippet-1">C#</a></div><div class="codeSnippetContainerTabActive" dir="ltr"><a>VB</a></div>
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_58e44bd7-b4a0-4e6d-a50e-9de4b1738ed4');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_58e44bd7-b4a0-4e6d-a50e-9de4b1738ed4" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre><span style="color:Blue;">Private</span> listView1 <span style="color:Blue;">As</span> ListView
<span style="color:Blue;">Private</span> imageList1 <span style="color:Blue;">As</span> ImageList


<span style="color:Blue;">Public</span> <span style="color:Blue;">Sub</span> ExtractAssociatedIconEx()

    <span style="color:Green;">' Initialize the ListView, ImageList and Form.</span>
    listView1 = <span style="color:Blue;">New</span> ListView()
    imageList1 = <span style="color:Blue;">New</span> ImageList()
    listView1.Location = <span style="color:Blue;">New</span> Point(37, 12)
    listView1.Size = <span style="color:Blue;">New</span> Size(161, 242)
    listView1.SmallImageList = imageList1
    listView1.View = View.SmallIcon
    <span style="color:Blue;">Me</span>.ClientSize = <span style="color:Blue;">New</span> System.Drawing.Size(292, 266)
    <span style="color:Blue;">Me</span>.Controls.Add(<span style="color:Blue;">Me</span>.listView1)
    <span style="color:Blue;">Me</span>.Text = <span style="color:#A31515;">"Form1"</span>

    <span style="color:Green;">' Get the c:\ directory.</span>
    <span style="color:Blue;">Dim</span> dir <span style="color:Blue;">As</span> <span style="color:Blue;">New</span> System.IO.DirectoryInfo(<span style="color:#A31515;">"c:\"</span>)

    <span style="color:Blue;">Dim</span> item <span style="color:Blue;">As</span> ListViewItem
    listView1.BeginUpdate()
    <span style="color:Blue;">Dim</span> file <span style="color:Blue;">As</span> System.IO.FileInfo
    <span style="color:Blue;">For</span> <span style="color:Blue;">Each</span> file <span style="color:Blue;">In</span> dir.GetFiles()

        <span style="color:Green;">' Set a default icon for the file.</span>
        <span style="color:Blue;">Dim</span> iconForFile <span style="color:Blue;">As</span> Icon = SystemIcons.WinLogo

        item = <span style="color:Blue;">New</span> ListViewItem(file.Name, 1)

        <span style="color:Green;">' Check to see if the image collection contains an image</span>
        <span style="color:Green;">' for this extension, using the extension as a key.</span>
        <span style="color:Blue;">If</span> <span style="color:Blue;">Not</span> (imageList1.Images.ContainsKey(file.Extension)) <span style="color:Blue;">Then</span>

            <span style="color:Green;">' If not, add the image to the image list.</span>
            iconForFile = System.Drawing.Icon.ExtractAssociatedIcon(file.FullName)
            imageList1.Images.Add(file.Extension, iconForFile)
        <span style="color:Blue;">End</span> <span style="color:Blue;">If</span>
        item.ImageKey = file.Extension
        listView1.Items.Add(item)

    <span style="color:Blue;">Next</span> file
    listView1.EndUpdate()
<span style="color:Blue;">End</span> <span style="color:Blue;">Sub</span>
</pre></div>
            
        </div>
    </div>
</div>
</div><div class="section"><h2 class="heading" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:xlink="http://www.w3.org/1999/xlink">Compiling the Code</h2><div class="section"><p>To compile the example:</p><ul class="unordered"><li><p>Paste the preceding code into a Windows Form, and call the <span class="code">ExtractAssociatedIconExample</span> method from the form's constructor or <a href="https://msdn.microsoft.com/en-us/library/system.windows.forms.form.load(v=vs.110).aspx">Load</a> event-handling method.</p><p>You will need to make sure that your form imports the <a href="https://msdn.microsoft.com/en-us/library/system.io(v=vs.110).aspx">System.IO</a> namespace.</p></li></ul></div></div><div><h2 class="LW_CollapsibleArea_TitleDiv"><div><a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="" role="button"><span class="cl_CollapsibleArea_expanding LW_CollapsibleArea_Img"></span><span class="LW_CollapsibleArea_Title">See Also</span></a><div id="Anchor_0" class="LW_CollapsibleArea_Anchor_Div active"><a href="https://msdn.microsoft.com/en-us/library/ms404308(v=vs.110).aspx#Anchor_0" class="LW_CollapsibleArea_Anchor_Img" title="Copy and share the link for this section"></a></div><div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div></div></h2><div class="sectionblock"><p><a href="https://msdn.microsoft.com/en-us/library/3ke1f63h(v=vs.110).aspx">Images, Bitmaps, and Metafiles</a><br><a href="https://msdn.microsoft.com/en-us/library/6dwb14tw(v=vs.110).aspx">ListView Control (Windows Forms)</a><br></p></div></div></div>
    </div>
  </div>
</div>


    




<div class="libraryMemberFilter">
    <div class="filterContainer">
        <span>Show:</span>
        <label>
            <input type="checkbox" class="libraryFilterInherited" checked="checked" value="Inherit">Inherited
        </label>
        <label>
            <input type="checkbox" class="libraryFilterProtected" checked="checked" value="Protected">Protected
        </label>
    </div>
</div>
    
<input type="hidden" id="libraryMemberFilterEmptyWarning" value="There are no members available with your current filter settings.">



    </div>

<div id="rightNavigationMenu" ms.pgarea="right nav" style="position: fixed; top: 60px;">
    <div id="mobileButtons">
        
    </div>
    <div id="navMain">
        <div id="closeNavigation">
            <a class="tocCloseSmall" id="closeButton"></a>
        </div>
        <div id="navigationButtons">
            <a id="provideFeedback2" href="javascript:void(0)"><ins class="suggestion"></ins>Any suggestions?</a>
            <a id="isd_print" href="https://msdn.microsoft.com/en-us/library/ms404308(d=printer,v=vs.110).aspx" rel="nofollow"><ins class="print"></ins>Print </a>
            <a id="isd_printABook2" href="https://msdn.microsoft.com/en-us/library/export/help/?returnUrl=%2fen-us%2flibrary%2fms404308(v%3dvs.110).aspx">
                <ins class="export"></ins>Export (<span class="count">0</span>)
            </a>
            <a id="isdShare" href="https://msdn.microsoft.com/en-us/library/ms404308(v=vs.110).aspx#">
                <ins class="share"></ins>Share
            </a>
            <div id="socials" style="display: none">
                <a id="isdFacebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fmsdn.microsoft.com%2Fen-us%2Flibrary%2Fms404308(v%3Dvs.110).aspx">
                    <ins class="facebook"></ins>
                </a>
                <a id="isdTwitter" href="https://twitter.com/intent/tweet?original_referer=https%3A%2F%2Fmsdn.microsoft.com%2Fen-us%2Flibrary%2Fms404308(v%3Dvs.110).aspx&text=How%20to%3A%20Extract%20the%20Icon%20Associated%20with%20a%20File%20in%20Windows%20Forms&tw_p=tweetbutton&url=https%3A%2F%2Fmsdn.microsoft.com%2Fen-us%2Flibrary%2Fms404308(v%3Dvs.110).aspx">
                    <ins class="twitter"></ins>
                </a>
                <a id="isdGooglePlus" href="https://plus.google.com/share?url=https%3A%2F%2Fmsdn.microsoft.com%2Fen-us%2Flibrary%2Fms404308(v%3Dvs.110).aspx">
                    <ins class="googlePlus"></ins>
                </a>
            </div>
        </div>
        <div id="indoc_toc" style="" ms.cmpgrp="indoc toc">
            <div id="indoc_title">IN THIS ARTICLE</div>
            <ul id="indoc_toclist"><li data-index="0" class="active">See Also</li></ul>
        </div>
    </div>
</div>
<div id="rightNavigationMenuThumbnail" class="rightNavigationMenuThumbnail">
</div>



        </div>
        <div class="clear"></div>

        

<input name="__RequestVerificationToken" type="hidden" value="kEa5mkQfLJ_jiGad4tgL5Ma5Zr9ONOaZFXkHsqfH8C6IuARjr1VuLvaMY5fIYymXRGovu-r6tl33xMppwaSQaenPH0I1">
<input id="ratingSubmitUrl" type="hidden" value="https://msdn.microsoft.com/en-us/library/feedback/add/ms404308(v=vs.110).aspx">
<input id="isTopicRated" type="hidden" value="false">

    <div id="lib-footer">
        <div id="responsiveRating" ms.pgarea="rating" class="show">
            

<div id="skinnyRating">
    <div class="closeSmallWhite"></div>
    <div class="rating">
        <div id="s_ratingSection1">
            <div class="title">
                Was this page helpful?
            </div>
            <div class="buttons">
                <button class="button" id="s_ratingYes" aria-label="Yes, this page was helpful">Yes</button>
                <button class="button" id="s_ratingNo" aria-label="No, this page was not helpful">No</button>
            </div>
            <input id="s_ratingValue" type="hidden" value="">
        </div>
        <div id="s_ratingSection2">
            <div id="s_skinnyRatingForm">
                <div class="title">
                    Additional feedback?
                </div>
                <textarea id="s_ratingText" rows="6" cols="" maxlength="1500"></textarea>
                <div class="right">
                    <div class="counter">
                        <span id="feedbackTextCounter">1500</span> characters remaining
                    </div>
                    <div class="buttons">
                        <button class="button" id="s_ratingSubmit" aria-label="Submit my additional feedback">Submit</button>
                        <button class="button" id="s_ratingSkipThis" aria-label="Skip additional feedback">Skip this</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="s_ratingSection3" style="display: none">
            <div class="title">
                Thank you!
            </div>
            <div class="description">
                We appreciate your feedback.
            </div>
        </div>

        
        <div id="contentFeedbackQAContainer" style="display: none;"></div>
    </div>
</div>


        </div>
        

    
    <link type="text/css" rel="stylesheet">
    
        
    <div id="ux-footer" class="" style="" dir="ltr">
        
            
        <div id="footerSock" class="both">
            <div id="footerSockInner">
                             
                    <div class="footerSockLeft"><div data-fragmentname="SocialLinks" id="Fragment_SocialLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">Follow us</div>
    <ul class="links">
      <li>
        <a href="http://www.facebook.com/microsoftdeveloper" target="_blank" id="SocialLinks_2151_19" class="facebook" xmlns="http://www.w3.org/1999/xhtml">http://www.facebook.com/microsoftdeveloper</a>
      </li>
      <li>
        <a href="https://twitter.com/msdev" target="_blank" id="SocialLinks_2151_20" class="twitter" xmlns="http://www.w3.org/1999/xhtml">https://twitter.com/msdev</a>
      </li>
      <li>
        <a href="http://plus.google.com/111221966647232053570/" target="_blank" id="SocialLinks_2151_21" class="googlePlus" xmlns="http://www.w3.org/1999/xhtml">http://plus.google.com/111221966647232053570/</a>
      </li>
    </ul>
  </div>
</div></div>
                        
                <div class="footerSockCenter">
                        <a name="feedback"></a>

<div class="rating">
    <div id="ratingSection1">
        <div class="title">
            Was this page helpful?
        </div>
        <div class="description">
            Your feedback about this content is important.<br>Let us know what you think.
        </div>
        <div class="buttons">
            <button class="button" id="ratingYes" aria-label="Yes, this page was helpful">Yes</button>
            <button class="button" id="ratingNo" aria-label="No, this page was not helpful">No</button>
        </div>
        <input id="ratingValue" type="hidden" value="">
    </div>
    <div id="ratingSection2">
        <div class="title left">
            Additional feedback?
        </div>
        <textarea id="ratingText" rows="6" cols="" maxlength="1500"></textarea>
        <div class="right">
            <div class="counter">
                <span id="feedbackTextCounter">1500</span> characters remaining
            </div>
            <div class="buttons">
                <button class="button" id="ratingSubmit" aria-label="Submit my additional feedback">Submit</button>
                <button class="button" id="ratingSkipThis" aria-label="Skip additional feedback">Skip this</button>
            </div>
        </div>
    </div>
    <div id="ratingSection3">
        <div class="title">
            Thank you!
        </div>
        <div class="description">
            We appreciate your feedback.
        </div>
    </div>
    
    
    <div id="contentFeedbackQAContainer" style="display: none;"></div>
</div>
    
                    <div class="userVoice">
    <div class="title">
        Have a suggestion?
    </div>
        <div class="description">
            Visit our UserVoice Page to submit and vote on ideas!
        </div>
    <div class="buttons">
        <a class="button" id="userVoiceButton" href="http://feedback.msdn.com/forums/257782-msdn-feature-suggestions/category/83975" target="_blank">Make a suggestion</a>
    </div>
</div>  
                </div>
                <div class="clear"></div>
            </div>
        </div>

        <footer class="top">
            <div data-fragmentname="LeftLinks" id="Fragment_LeftLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">Dev centers</div>
    <ul class="links">
      <li>
        <a href="https://dev.windows.com/" id="LeftLinks_2148_1" class="windowsBlue" xmlns="http://www.w3.org/1999/xhtml">Windows</a>
      </li>
      <li>
        <a href="http://dev.office.com/" id="LeftLinks_2148_3" class="office" xmlns="http://www.w3.org/1999/xhtml">Office</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/vstudio" id="LeftLinks_2148_4" class="visualStudio" xmlns="http://www.w3.org/1999/xhtml">Visual Studio</a>
      </li>
      <li>
        <a href="http://azure.microsoft.com/en-us/documentation/" target="_blank" id="LeftLinks_2148_12" xmlns="http://www.w3.org/1999/xhtml">Microsoft Azure</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/developer-centers-msdn" id="LeftLinks_2148_5" xmlns="http://www.w3.org/1999/xhtml">More...</a>
      </li>
    </ul>
  </div>
</div>
            <div id="rightLinks">
                <div data-fragmentname="CenterLinks1" id="Fragment_CenterLinks1" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">Learning resources</div>
    <ul class="links">
      <li>
        <a href="http://www.microsoftvirtualacademy.com/" id="CenterLinks1_2151_4" xmlns="http://www.w3.org/1999/xhtml">Microsoft Virtual Academy</a>
      </li>
      <li>
        <a href="http://channel9.msdn.com/" id="CenterLinks1_2151_5" xmlns="http://www.w3.org/1999/xhtml">Channel 9</a>
      </li>
      <li>
        <a href="http://www.interoperabilitybridges.com/" id="CenterLinks1_2151_6" xmlns="http://www.w3.org/1999/xhtml">Interoperability Bridges</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/magazine/" id="CenterLinks1_2151_7" xmlns="http://www.w3.org/1999/xhtml">MSDN Magazine</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks2" id="Fragment_CenterLinks2" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">Community</div>
    <ul class="links">
      <li>
        <a href="https://social.msdn.microsoft.com/forums/en-us/home" id="CenterLinks2_2151_8" xmlns="http://www.w3.org/1999/xhtml">Forums</a>
      </li>
      <li>
        <a href="http://blogs.msdn.com/b/developer-tools/" id="CenterLinks2_2151_9" xmlns="http://www.w3.org/1999/xhtml">Blogs</a>
      </li>
      <li>
        <a href="http://www.codeplex.com/" id="CenterLinks2_2151_10" xmlns="http://www.w3.org/1999/xhtml">Codeplex</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks3" id="Fragment_CenterLinks3" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <div class="linkListTitle">Support</div>
    <ul class="links">
      <li>
        <a href="https://msdn.microsoft.com/hh361695" id="CenterLinks3_2151_11" xmlns="http://www.w3.org/1999/xhtml">Self support</a>
      </li>
    </ul>
  </div>
</div>
                <div data-fragmentname="CenterLinks4" id="Fragment_CenterLinks4" xmlns="http://www.w3.org/1999/xhtml" class="nth-child-4n">
  
  <div class="linkList">
    <div class="linkListTitle">Programs</div>
    <ul class="links">
      <li>
        <a href="https://www.microsoft.com/bizspark/" id="CenterLinks4_2151_13" xmlns="http://www.w3.org/1999/xhtml">BizSpark (for startups)</a>
      </li>
      <li>
        <a href="https://www.dreamspark.com/" id="CenterLinks4_2151_14" xmlns="http://www.w3.org/1999/xhtml">DreamSpark</a>
      </li>
      <li>
        <a href="http://www.imaginecup.com/" id="CenterLinks4_2151_17" xmlns="http://www.w3.org/1999/xhtml">Imagine Cup</a>
      </li>
    </ul>
  </div>
</div>
            </div>
        </footer>

        <footer class="bottom">
            <span class="localeContainer">
                
    <form class="selectLocale" id="selectLocaleForm" action="https://msdn.microsoft.com/en-us/selectlocale-dmc">
        <input type="hidden" name="fromPage" value="https%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fms404308(v%3dvs.110).aspx">
        <a href="https://msdn.microsoft.com/en-us/library/ms404308(v=vs.110).aspx#" onclick="$(&#39;#selectLocaleForm&#39;).submit();return false;" title="Change your language">United States (English)</a>
    </form>


            </span>

            <div data-fragmentname="BottomLinks" id="Fragment_BottomLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="linkList">
    <ul class="links horizontal">
      <li>
        <a href="https://msdn.microsoft.com/newsletter.aspx" id="BottomLinks_2148_7" xmlns="http://www.w3.org/1999/xhtml">Newsletter</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/dn529288" id="BottomLinks_2148_8" xmlns="http://www.w3.org/1999/xhtml">Privacy &amp; cookies</a>
      </li>
      <li>
        <a href="https://msdn.microsoft.com/cc300389" id="BottomLinks_2148_9" xmlns="http://www.w3.org/1999/xhtml">Terms of use</a>
      </li>
      <li>
        <a href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" id="BottomLinks_2148_10" xmlns="http://www.w3.org/1999/xhtml">Trademarks</a>
      </li>
    </ul>
  </div>
</div>
            <span class="logoLegal">
                <span class="logo"></span>
                <span class="copyright"> 2015 Microsoft</span>
            </span>
        </footer>
    </div>
    

    </div>

        <div class="footerPrintView">
            <div class="footerCopyrightPrintView"> 2015 Microsoft</div>
        </div>

        
        

        
        

    <input id="tocPaddingPerLevel" type="hidden" value="17">



        <input id="MtpsDevice" type="hidden" value="Default">


<!--[CDATA[ Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code, not by Microsoft.  See ASP.NET Ajax CDN Terms of Use  http://www.asp.net/ajaxlibrary/CDN.ashx. ]]-->

        
        
        
            
        






<noscript>&lt;div&gt;&lt;img alt="DCSIMG" id="Img1" width="1" height="1" src="https://m.webtrends.com/dcsmgru7m99k7mqmgrhudo0k8_8c6m/njs.gif?dcsuri=/nojavascript&amp;amp;WT.js=No" /&gt;&lt;/div&gt;</noscript>








<div id="globalRequestVerification">
    <input name="__RequestVerificationToken" type="hidden" value="k2IylwFwvjyevYuEwuSsr94adbZou9yBzag8kD7IbFrX63y1ADqCHoHCRnSVegsdVZqmMuVud-CxQJRMGPP1FYQas1c1">
</div>


    </div>

    
    

    
<script type="text/javascript" class="mtps-injected">
/*<![CDATA[*/
(function(window,document){"use strict";function preload(scripts){for(var result=[],script,e,i=0;i<scripts.length;i++)script=scripts[i],script.hasOwnProperty("url")&&(e=document.createElement("script"),e.src=script.url,script.throwaway=e),result.push(script);return result}function inject(scripts,index){var script,elem;if(index>=scripts.length){delete mtps.injectScripts;return}script=scripts[index];elem=document.createElement("script");elem.className="mtps-injected";elem.async=!1;var isLoaded=!1,timeoutId=0,injectNextFnName="",injectNext=elem.onerror=function(){isLoaded||(isLoaded=!0,inject(scripts,index+1),window.clearTimeout(timeoutId),elem.onload=elem.onerror=elem.onreadystatechange=null,injectNextFnName&&delete mtps[injectNextFnName],elem.removeEventListener&&elem.removeEventListener("load",injectNext,!1))};elem.addEventListener?elem.addEventListener("load",injectNext,!1):elem.readyState==="uninitialized"?elem.onreadystatechange=function(){(this.readyState==="loaded"||this.readyState==="complete")&&injectNext()}:elem.onload=injectNext;script.hasOwnProperty("url")?(timeoutId=window.setTimeout(injectNext,12e4),elem.src=script.url):(injectNextFnName="_injectNextScript_"+index,mtps[injectNextFnName]=injectNext,timeoutId=window.setTimeout(injectNext,2e3),elem.text="try {\n"+script.txt+"\n} finally { MTPS."+injectNextFnName+" && MTPS."+injectNextFnName+"(); }");parent.appendChild(elem)}var mtps=window.MTPS||(window.MTPS={}),parent=document.getElementsByTagName("head")[0];mtps.injectScripts=function(scripts){inject(preload(scripts),0)}})(window,document);
MTPS.injectScripts([
	{ txt: "/**/\r\n(window.MTPS || (window.MTPS = {})).cdnDomains || (window.MTPS.cdnDomains = { \r\n\t\"image\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"js\": \"https://i2-msdn.sec.s-msft.com\", \r\n\t\"css\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"xap\": \"https://msdn.microsoft.com\"\r\n});\r\n/**/" },
	{ txt: "//\n  var literalNormalizedUrl = \u0027/en-us/library/ms404308(l=en-us,v=vs.110).aspx\u0027;\n  var wt_nvr_ru = \u0027WT_NVR_RU\u0027;\n  var wt_fpcdom = \u0027.microsoft.com\u0027;\n  var wt_domlist = \u0027msdn.microsoft.com\u0027;\n  var wt_pathlist = \u0027\u0027;\n  var wt_paramlist = \u0027DCSext.mtps_devcenter\u0027;\n  var wt_siteid = \u0027MSDN\u0027;\n  var gDomain = \u0027m.webtrends.com\u0027;\n  var gDcsId = \u0027dcsmgru7m99k7mqmgrhudo0k8_8c6m\u0027;\n  var gFpc = \u0027WT_FPC\u0027;\n\n\n\n  if (document.cookie.indexOf(gFpc + \"=\") == -1) {\n    var wtidJs = document.createElement(\"script\");\n    wtidJs.src = \"//\" + gDomain + \"/\" + gDcsId + \"/wtid.js\";\n    document.getElementsByTagName(\"head\")[0].appendChild(wtidJs);\n  }\n\n\n\n  var detectedLocale = \u0027en-us\u0027;\n  var wtsp = \u0027msdnlib_dotnet\u0027;\n  var gTrackEvents = \u00270\u0027;\n/**/" },
	{ txt: "//\n\n        window.appInsightsId = \u002760854590-027a-4ae4-98be-2741a40f355f\u0027;\n        //" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:Utilities,1:Layout,2:Header,3:Breadcrumbs,4:LibraryRightNavigationMenu,4:PrintExportButton,4:SkinnyRating,1:Rating,2:Footer,0:Topic,5:webtrendsscript,4:WEDCS,0:ScrollTracking,3:CmpgrpForHeader,0:AppInsightsPerf,3:ResponsiveToc,1:SearchBox;/Areas/Epx/Content/Scripts:0,/Areas/Epx/Themes/Base/Content:1,/Areas/Centers/Themes/StandardDevCenter/Content:2,/Areas/Library/Content:3,/Areas/Library/Themes/Base/Content:4,/Areas/Global/Content/Webtrends/resources:5\u0026amp;hashKey=DDD0A428CE386C786BB35F52FF666C75\u0026amp;v=BAE4BFF80C14320A4DCC684282920D9A" },
	{ url: "https://i1.services.social.microsoft.com/search/Widgets/SearchBox.jss?boxid=HeaderSearchTextBox\u0026btnid=HeaderSearchButton\u0026pgArea=header\u0026brand=Msdn\u0026loc=en-us\u0026focusOnInit=false\u0026emptyWatermark=true\u0026searchButtonTooltip=Search MSDN" },
	{ txt: "MTPS = window.MTPS || {}; MTPS.LocalizedStrings = window.MTPS.LocalizedStrings || {}; MTPS.LocalizedStrings.ExpandButtonTooltip = \u0027Expand\u0027; MTPS.LocalizedStrings.CollapseButtonTooltip = \u0027Collapse\u0027; MTPS.LocalizedStrings.EnhancedExpandTooltip = \u0027Click to expand. Double-click to expand all.\u0027; MTPS.LocalizedStrings.EnhancedCollapseTooltip = \u0027Click to collapse. Double-click to collapse all.\u0027; MTPS.LocalizedStrings.ExpandAllButtonTooltip = \u0027Expand All\u0027; MTPS.LocalizedStrings.CollapseAllButtonTooltip = \u0027Collapse All\u0027;" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:LibraryMemberFilter,1:Toc_Fixed,1:CodeSnippet,1:TopicNotInScope,0:ResponsiveSupport,1:VersionSelector,1:SurveyBroker;/Areas/Library/Content:0,/Areas/Epx/Content/Scripts:1\u0026amp;hashKey=CDA41F7EA7DE185FBCE7B189AEA99930\u0026amp;v=BAE4BFF80C14320A4DCC684282920D9A" },
	{ txt: "$(document).ready(function() {\n        try {\n            var token = $(\"#globalRequestVerification input[name=\u0027__RequestVerificationToken\u0027]\").clone();\n            $(\"#siteFeedbackForm\").append(token);\n        } catch(err) {\n            \n        }\n    });" }
]);

/*]]>*/
</script>







<div id="overlayMask"></div><script src="./How to_ Extract the Icon Associated with a File in Windows Forms_files/broker-config.js"></script></body></html>